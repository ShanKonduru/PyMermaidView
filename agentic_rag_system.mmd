flowchart TD
    User[ğŸ‘¤ User Query] --> Interface{Interface Type}
    
    Interface -->|CLI Mode| CLI[ğŸ–¥ï¸ Interactive CLI]
    Interface -->|API Mode| API[ğŸŒ FastAPI Server]
    Interface -->|Single Query| Direct[âš¡ Direct Processing]
    
    CLI --> System[ğŸ¯ AgenticRAG System]
    API --> System
    Direct --> System
    
    System --> Config[âš™ï¸ Configuration Manager]
    Config --> LLM[ğŸ¤– Language Model<br/>Ollama/OpenAI]
    Config --> VectorDB[ğŸ” Vector Database<br/>ChromaDB/Qdrant]
    
    System --> StateManager[ğŸ“Š Enhanced State Manager]
    StateManager --> Memory[ğŸ§  Agent Memory]
    StateManager --> ErrorHandler[âŒ Error Handler]
    StateManager --> Metrics[ğŸ“ˆ Performance Metrics]
    
    System --> DataManager[ğŸ“ Data Source Manager]
    DataManager --> FileSource[ğŸ“„ File Sources<br/>PDF, DOCX, TXT, JSON]
    DataManager --> WebSource[ğŸŒ Web Sources<br/>URL Scraping]
    DataManager --> DBSource[ğŸ—„ï¸ Database Sources<br/>SQL Queries]
    DataManager --> APISource[ğŸ”— API Sources<br/>REST Endpoints]
    
    FileSource --> Processing[âš¡ Document Processing]
    WebSource --> Processing
    DBSource --> Processing
    APISource --> Processing
    
    Processing --> Chunking[âœ‚ï¸ Text Chunking]
    Processing --> Embedding[ğŸ”¢ Embedding Generation]
    Chunking --> VectorDB
    Embedding --> VectorDB
    
    System --> AgentOrchestrator[ğŸ­ Agent Orchestrator]
    
    AgentOrchestrator --> PlanningAgent[ğŸ¯ Planning Agent]
    PlanningAgent --> ReactReasoning[ğŸ¤” ReAct Reasoning]
    ReactReasoning --> ExecutionPlan[ğŸ“‹ Execution Plan]
    
    ExecutionPlan --> RetrievalAgents[ğŸ” Retrieval Agents]
    RetrievalAgents --> LocalRAG[ğŸ“š Local RAG Agent]
    RetrievalAgents --> WebSearch[ğŸŒ Web Search Agent]
    RetrievalAgents --> DatabaseAgent[ğŸ—„ï¸ Database Agent]
    
    LocalRAG --> VectorSearch[ğŸ” Vector Search]
    VectorSearch --> VectorDB
    VectorDB --> SearchResults[ğŸ“‹ Search Results]
    
    SearchResults --> AggregatorAgent[ğŸ¯ Aggregator Agent]
    AggregatorAgent --> Synthesis[âš—ï¸ Response Synthesis]
    Synthesis --> QualityAssessment[âœ… Quality Assessment]
    QualityAssessment --> FinalResponse[ğŸ“ Final Response]
    
    FinalResponse --> ResponseDelivery{Response Delivery}
    ResponseDelivery -->|CLI| CLIOutput[ğŸ–¥ï¸ CLI Output]
    ResponseDelivery -->|API| JSONResponse[ğŸ“„ JSON Response]
    ResponseDelivery -->|Direct| PythonObject[ğŸ Python Object]
    
    System --> Monitoring[ğŸ“Š System Monitoring]
    Monitoring --> Logging[ğŸ“ Comprehensive Logging]
    Monitoring --> HealthChecks[ğŸ’š Health Checks]
    Monitoring --> Analytics[ğŸ“ˆ Performance Analytics]
    
    classDef userNode fill:#e1f5fe,stroke:#01579b,stroke-width:2px
    classDef systemNode fill:#f3e5f5,stroke:#4a148c,stroke-width:2px
    classDef agentNode fill:#e8f5e8,stroke:#2e7d32,stroke-width:2px
    classDef dataNode fill:#fff3e0,stroke:#e65100,stroke-width:2px
    classDef outputNode fill:#fce4ec,stroke:#ad1457,stroke-width:2px
    
    class User,Interface,CLI,API,Direct userNode
    class System,AgentOrchestrator,StateManager,Config systemNode
    class PlanningAgent,LocalRAG,WebSearch,DatabaseAgent,AggregatorAgent agentNode
    class DataManager,FileSource,WebSource,DBSource,VectorDB dataNode
    class FinalResponse,CLIOutput,JSONResponse,PythonObject outputNode